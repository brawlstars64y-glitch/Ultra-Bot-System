const { Telegraf } = require('telegraf');
const http = require('http');

// ðŸ›¡ï¸ Ø³Ø­Ø¨ Ø§Ù„ØªÙˆÙƒÙ† Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙÙŠ Railway
const token = process.env.BOT_TOKEN;

if (!token) {
  console.error("âŒ Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ BOT_TOKEN ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª!");
  process.exit(1);
}

const bot = new Telegraf(token);

// ðŸŒ Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙŠØ±ÙØ± ÙˆÙŠØ¨ Ø¨Ø³ÙŠØ· Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª Ù†Ø´Ø·Ø§Ù‹ Ø¹Ù„Ù‰ Railway
http.createServer((req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain; charset=utf-8' });
  res.write("ðŸ’Ž Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø£Ø¹Ù„Ù‰ ÙƒÙØ§Ø¡Ø©");
  res.end();
}).listen(process.env.PORT || 3000);

// âœ¨ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©
bot.start((ctx) => {
  const welcomeMessage = `
ðŸš€ **Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ ÙŠØ§ Ø¨Ø·Ù„Ø© ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©!**

ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø£Ù†ØªÙ Ø§Ù„Ø¢Ù† ØªØ³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ø§Ù„Ù…Ø·ÙˆØ±Ø© Ø®ØµÙŠØµØ§Ù‹ Ù„ØªÙ†Ø§Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒÙ.

ðŸ›¡ï¸ **Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© (Protection):**
Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒÙ Ù…Ø´ÙØ±Ø© ÙˆÙ…Ø¤Ù…Ù†Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ Ø¨ÙŠØ¦Ø© Railway Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©.

âš™ï¸ **Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ÙŠÙ† Ø£Ù† Ù†ÙØ¹Ù„ Ø§Ù„Ø¢Ù†ØŸ**
Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„Ø¨Ø¯Ø¡.
  `;
  ctx.replyWithMarkdown(welcomeMessage);
});

// ðŸ“Š Ø£Ù…Ø± ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
bot.command('status', (ctx) => {
  ctx.replyWithMarkdown('ðŸ“Š **ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…:**\n\nâœ… Ø§Ù„Ø³ÙŠØ±ÙØ±: Ù…ØªØµÙ„ (Online)\nâœ… Ø§Ù„Ø³Ø±Ø¹Ø©: Ù…Ù…ØªØ§Ø²Ø©\nâœ… Ø§Ù„Ø­Ù…Ø§ÙŠØ©: 100%');
});

// ðŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
bot.launch({
  polling: {
    dropPendingUpdates: true
  }
}).then(() => {
  console.log("ðŸš€ ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!");
}).catch((err) => {
  console.error("âŒ ÙØ´Ù„ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ut:", err);
});

// ðŸ›‘ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ø§Ù„Ø¢Ù…Ù† Ù…Ø¹ Ø§Ù„ØªÙˆÙ‚Ù Ø§Ù„Ù…ÙØ§Ø¬Ø¦
process.once('SIGINT', () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM'));
